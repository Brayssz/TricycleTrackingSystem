/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 1.3.8
 *
 */(function(l){l.fn.extend({slimScroll:function(n){var e=l.extend({width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},n);return this.each(function(){function m(a){if(b){a=a||window.event;var r=0;a.wheelDelta&&(r=-a.wheelDelta/120),a.detail&&(r=a.detail/3),l(a.target||a.srcTarget||a.srcElement).closest("."+e.wrapperClass).is(i.parent())&&d(r,!0),a.preventDefault&&!c&&a.preventDefault(),c||(a.returnValue=!1)}}function d(a,r,M){c=!1;var o=i.outerHeight()-s.outerHeight();r&&(r=parseInt(s.css("top"))+a*parseInt(e.wheelStep)/100*s.outerHeight(),r=Math.min(Math.max(r,0),o),r=0<a?Math.ceil(r):Math.floor(r),s.css({top:r+"px"})),h=parseInt(s.css("top"))/(i.outerHeight()-s.outerHeight()),r=h*(i[0].scrollHeight-i.outerHeight()),M&&(r=a,a=r/i[0].scrollHeight*i.outerHeight(),a=Math.min(Math.max(a,0),o),s.css({top:a+"px"})),i.scrollTop(r),i.trigger("slimscrolling",~~r),x(),g()}function y(){v=Math.max(i.outerHeight()/i[0].scrollHeight*i.outerHeight(),30),s.css({height:v+"px"});var a=v==i.outerHeight()?"none":"block";s.css({display:a})}function x(){y(),clearTimeout(E),h==~~h?(c=e.allowPageScroll,R!=h&&i.trigger("slimscroll",~~h==0?"top":"bottom")):c=!1,R=h,v>=i.outerHeight()?c=!0:(s.stop(!0,!0).fadeIn("fast"),e.railVisible&&p.stop(!0,!0).fadeIn("fast"))}function g(){e.alwaysVisible||(E=setTimeout(function(){e.disableFadeOut&&b||C||H||(s.fadeOut("slow"),p.fadeOut("slow"))},1e3))}var b,C,H,E,S,v,h,R,c=!1,i=l(this);if(i.parent().hasClass(e.wrapperClass)){var f=i.scrollTop(),s=i.siblings("."+e.barClass),p=i.siblings("."+e.railClass);if(y(),l.isPlainObject(n)){if("height"in n&&n.height=="auto"){i.parent().css("height","auto"),i.css("height","auto");var u=i.parent().parent().height();i.parent().css("height",u),i.css("height",u)}else"height"in n&&(u=n.height,i.parent().css("height",u),i.css("height",u));if("scrollTo"in n)f=parseInt(e.scrollTo);else if("scrollBy"in n)f+=parseInt(e.scrollBy);else if("destroy"in n){s.remove(),p.remove(),i.unwrap();return}d(f,!1,!0)}}else if(!(l.isPlainObject(n)&&"destroy"in n)){e.height=e.height=="auto"?i.parent().height():e.height,f=l("<div></div>").addClass(e.wrapperClass).css({position:"relative",overflow:"hidden",width:e.width,height:e.height}),i.css({overflow:"hidden",width:e.width,height:e.height});var p=l("<div></div>").addClass(e.railClass).css({width:e.size,height:"100%",position:"absolute",top:0,display:e.alwaysVisible&&e.railVisible?"block":"none","border-radius":e.railBorderRadius,background:e.railColor,opacity:e.railOpacity,zIndex:90}),s=l("<div></div>").addClass(e.barClass).css({background:e.color,width:e.size,position:"absolute",top:0,opacity:e.opacity,display:e.alwaysVisible?"block":"none","border-radius":e.borderRadius,BorderRadius:e.borderRadius,MozBorderRadius:e.borderRadius,WebkitBorderRadius:e.borderRadius,zIndex:99}),u=e.position=="right"?{right:e.distance}:{left:e.distance};p.css(u),s.css(u),i.wrap(f),i.parent().append(s),i.parent().append(p),e.railDraggable&&s.bind("mousedown",function(o){var w=l(document);return H=!0,t=parseFloat(s.css("top")),pageY=o.pageY,w.bind("mousemove.slimscroll",function(D){currTop=t+D.pageY-pageY,s.css("top",currTop),d(0,s.position().top,!1)}),w.bind("mouseup.slimscroll",function(D){H=!1,g(),w.unbind(".slimscroll")}),!1}).bind("selectstart.slimscroll",function(o){return o.stopPropagation(),o.preventDefault(),!1}),p.hover(function(){x()},function(){g()}),s.hover(function(){C=!0},function(){C=!1}),i.hover(function(){b=!0,x(),g()},function(){b=!1,g()}),i.bind("touchstart",function(o,w){o.originalEvent.touches.length&&(S=o.originalEvent.touches[0].pageY)}),i.bind("touchmove",function(o){c||o.originalEvent.preventDefault(),o.originalEvent.touches.length&&(d((S-o.originalEvent.touches[0].pageY)/e.touchScrollStep,!0),S=o.originalEvent.touches[0].pageY)}),y(),e.start==="bottom"?(s.css({top:i.outerHeight()-s.outerHeight()}),d(0,!0)):e.start!=="top"&&(d(l(e.start).position().top,null,!0),e.alwaysVisible||s.hide()),window.addEventListener?(this.addEventListener("DOMMouseScroll",m,!1),this.addEventListener("mousewheel",m,!1)):document.attachEvent("onmousewheel",m)}}),this}}),l.fn.extend({slimscroll:l.fn.slimScroll})})(jQuery);
